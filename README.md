# 上市股票的投資組合歷史回測：RSI指標
<br>
1.	先抓取歷史股價資料<br>
利用requests將臺灣證券交易所的股價資料傳入Excel內。<br>
由於台灣證交所的url一次只能傳輸一個月內的股價資料，因此我透過迴圈的方式將資料合併，只需輸入目標股票代碼（須為上市股票）及想要回測的歷史期間的起始日期與最終日期就可以了。<br>
<br>
2.	建立歷史回測<br>
將歷史股價資料中的”close”匯入新的工作簿中。利用”close”算出每個股票的股價變化。再來就是用股價變化算出長期(14d)與短期(7d)的RSI  index. <br>
RSI  index=n日漲幅平均值/(n日漲幅平均值+n日跌幅平均值)*100. <br>
n日漲幅平均值＝n日內上漲日總上漲幅度加總/n<br>
n日跌幅平均值=n日內下跌日總下跌幅度加總/n<br>
若短期RSI>長期RSI，則視為買進訊號；若短期RSI<長期RSI，則視為賣出訊號。<br>
<br>
3.	投資組合收益檢測<br>
將各股票的歷史回測最終的總資產減去起始資金算出個股票的收益，再將所有股票的收益加總，算出總收益。<br>
<br>
4.	回傳總收益訊息<br>
透過line notify將這次的投資組合歷史回測的總收益傳到line通知<br>


